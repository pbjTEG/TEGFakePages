/*
* TEG Fake Pages
*
* Add fake pagination. 
*
* Author: Paul B. Joiner <paulj@engageyourcause.com>
* Copyright (c) 2022 PMG: The Engage Group
* License: MIT
*
* Release:
*   Version: v2.0
*   Branch:  master
*   Git Tag: v2.0
*   Date:    20221018
*/
class TEGFakePages{#currentPageObject;#currentPageNumber=0;#lastPageNumber=0;#pageObjects;#newPageNumber;constructor(e){const i=this;if(i.options={formSelector:"form.en__component.en__component--page",currentPageNumber:1,currentPageClass:"current",pageStartSelector:".step",pageExcludeSelector:".step-exclude",pageItemClass:"step-item",pageItemParentSelector:".en__component",pageIDPrefix:"step",errorSelector:".en__field__error",submitSelector:".en__submit > button",pageLength:0,breadcrumbs:jQuery('<div class="row"></div>'),breadcrumbItemMobile:jQuery('<div class="row"></div>').append('<div class="col-2 previous" tabindex="0" aria-label="previous page">&nbsp;</div>').append('<div class="col title" />').append('<div class="col-2 next" tabindex="0" aria-label="next page">&nbsp;</div>'),breadcrumbItemTablet:jQuery('<div class="col title" tabindex="0"></div>'),breadcrumbItemDesktop:jQuery('<div class="col title" tabindex="0"></div>'),pageButtons:jQuery('<div class="step-nav"/>'),backButton:jQuery('<button class="step-back">Back</button>'),continueButton:jQuery('<button class="step-next">Continue</button>'),buttonPlacement:TEGFakePages.BUTTON_AFTER,pageChange:{0:{beforeShow:function(e,t){return t.find(i.options.errorSelector).hide(),!0},beforeHide:function(e,t){return"none"===i.options.runValidation||t.find(i.options.errorSelector).is(":visible")}}},runValidation:"engagingNetworks",runValidationTypes:{engagingNetworks:{nextButtonFunc:function(){return i.#newPageNumber=i.#currentPageNumber+1,!0},setup:function(){window.enOnError=function(){i.currentPageObject.removeClass(i.options.sectionErrorClass),i.form.removeClass(i.options.formErrorClass),0<i.currentPageObject.find(i.options.errorSelector).length?(i.currentPageObject.addClass(i.options.sectionErrorClass),i.form.addClass(i.options.formErrorClass)):i.#currentPageNumber<i.#lastPageNumber&&(i.currentPageObject.siblings("section").removeClass(i.options.sectionErrorClass).find(i.options.errorSelector).remove(),i.goPage(i.newPageNumber,!1))},window.enOnSubmit=function(){return i.#pageObjects.removeClass(i.options.sectionErrorClass),i.form.removeClass(i.options.formErrorClass),0===i.#currentPageNumber||i.#currentPageNumber===i.#lastPageNumber||(i.goPage(i.#newPageNumber),!1)}}},none:{nextButtonFunc:function(e){i.nextPage(e)},setup:function(){}},custom:{nextButtonFunc:function(e){},setup:function(){}}},sectionErrorClass:"sectionError",formErrorClass:"formError",windowSizeOptions:{},afterLoad:()=>!0},jQuery.extend(i.options,e),i.form=jQuery(i.options.formSelector),0===i.form.length)return!1;if(i.body=jQuery("body"),"object"!=typeof jQuery.windowSize)return console&&console.log("TEG Fake Pages won't load without TEG jQuery Utilities."),!1;if(jQuery.windowSize.init(i.options.windowSizeOptions),i.#currentPageNumber=i.options.currentPageNumber,i.#newPageNumber=i.#currentPageNumber,0<i.options.pageLength){let t=i.form.children(i.options.pageStartSelector),o=[];for(let e=0;e<t.length;e+=i.options.pageLength)o.push(t.slice(e,e+i.options.pageLength).wrapAll(jQuery("<section/>").addClass(i.options.pageItemClass).attr("id",i.options.pageIDPrefix+e)));i.#lastPageNumber=o.length,i.options.buttonPlacement!==TEGFakePages.BUTTON_NONE&&0<i.options.pageButtons.length&&0<i.#lastPageNumber&&(i.options.backButton.attr("data-fpbutton","back"),i.options.continueButton.attr("data-fpbutton","next"),i.options.pageButtons.on("click keydown",e=>{var t=jQuery(e.target).attr("data-fpbutton")||"none";"back"===t&&i.previousPage(e),"next"===t&&i.options.runValidationTypes[i.options.runValidation].nextButtonFunc(e)}),i.options.pageButtons.append(i.options.continueButton).append(i.options.backButton),i.options.buttonPlacement!==TEGFakePages.BUTTON_BEFORE&&i.options.buttonPlacement!==TEGFakePages.BUTTON_BOTH||i.form.prepend(i.options.pageButtons.clone(!0)),i.options.buttonPlacement!==TEGFakePages.BUTTON_AFTER&&i.options.buttonPlacement!==TEGFakePages.BUTTON_BOTH||i.form.append(i.options.pageButtons.clone(!0)))}else i.#lastPageNumber=jQuery(i.options.pageStartSelector).each(function(e){const t=jQuery(this),o=jQuery("<section/>").addClass(i.options.pageItemClass).attr("id",i.options.pageIDPrefix+e),n=t.closest(i.options.pageItemParentSelector);var r,a,s;0<n.length?(o.insertBefore(n),n.nextUntil(i.options.pageItemParentSelector+":has("+i.options.pageStartSelector+"), "+i.options.pageItemParentSelector+":has("+i.options.pageExcludeSelector+")").addBack().appendTo(o)):(o.insertBefore(t),t.nextUntil(i.options.pageStartSelector+", "+i.options.pageExcludeSelector).addBack().appendTo(o)),0<i.options.breadcrumbs.length&&(jQuery.windowSize.isMobile&&0<i.options.breadcrumbItemMobile.length?s=i.options.breadcrumbItemMobile.clone():jQuery.windowSize.isTablet&&0<i.options.breadcrumbItemTablet.length?s=i.options.breadcrumbItemTablet.clone():jQuery.windowSize.isDesktop&&0<i.options.breadcrumbItemDesktop.length&&(s=i.options.breadcrumbItemDesktop.clone()),a=void 0!==t.attr("data-breadcrumb")?t.attr("data-breadcrumb"):t.html(),0<s.find(".previous, .next").length?(s.find(".previous").on("click keydown tap",function(e){i.previousPage(e)}),s.find(".next").on("click keydown tap",function(e){"true"===jQuery(this).attr("data-visited")&&i.nextPage(e)}),s.attr("data-step",e+1)):s.attr("data-step",e+1).on("click keydown tap",function(e){e.preventDefault(),e.stopImmediatePropagation();e=jQuery(this);"true"===e.attr("data-visited")&&i.goPage(+e.attr("data-step"))}),(r=(r=s).is(".title")?r:s.find(".title")).html(a),i.options.breadcrumbs.append(s).prependTo(i.form)),i.options.buttonPlacement>TEGFakePages.BUTTON_NONE&&0<i.options.pageButtons.length&&(r=i.options.pageButtons.clone(),a=i.options.continueButton.clone().on("click keydown",function(e){i.options.runValidationTypes[i.options.runValidation].nextButtonFunc(e)}),s=i.options.backButton.clone().on("click keydown",function(e){i.previousPage(e)}),0===e?r.append(a):(0<o.find(i.options.submitSelector).length?r.append(o.find(i.options.submitSelector)):r.append(a)).append(s),i.options.buttonPlacement%2==1&&o.prepend(r),i.options.buttonPlacement!==TEGFakePages.BUTTON_AFTER&&i.options.buttonPlacement!==TEGFakePages.BUTTON_BOTH||o.append(r))}).length;i.#pageObjects=i.form.find('[id^="'+i.options.pageIDPrefix+'"]'),i.#currentPageObject=i.#pageObjects.eq(i.#currentPageNumber-1).addClass(i.options.currentPageClass),i.options.runValidationTypes[i.options.runValidation].setup(),0<i.form.find(i.options.errorSelector+":visible").length?i.errorPage():(i.goPage(i.#currentPageNumber),jQuery('[data-step="'+i.#currentPageNumber+'"]').attr("data-visited","true"),i.options.afterLoad(i.options))}static get BUTTON_NONE(){return 0}static get BUTTON_BEFORE(){return 1}static get BUTTON_AFTER(){return 2}static get BUTTON_BOTH(){return 3}get currentPageObject(){return this.#currentPageObject}get currentPageNumber(){return this.#currentPageNumber}get pageObjects(){return this.#pageObjects}get lastPageNumber(){return this.#lastPageNumber}get newPageNumber(){return this.#newPageNumber}goPage(e,t){return t=t&&"function"==typeof this.options.runValidation,!(e>this.#lastPageNumber)&&(!(e>this.#currentPageNumber&&t&&this.#currentPageObject.find(this.options.errorSelector).is(":visible"))&&(this.options.pageChange[0].hasOwnProperty("beforeHide")&&this.options.pageChange[0].beforeHide(this.#currentPageNumber,this.#currentPageObject),!(this.options.pageChange.hasOwnProperty(this.#currentPageNumber)&&this.options.pageChange[this.#currentPageNumber].hasOwnProperty("beforeHide")&&!this.options.pageChange[this.#currentPageNumber].beforeHide(this.#currentPageNumber,this.#currentPageObject))&&(this.options.pageChange[0].hasOwnProperty("beforeShow")&&this.options.pageChange[0].beforeShow(e,this.#pageObjects.eq(e)),this.options.pageChange.hasOwnProperty(e)&&this.options.pageChange[e].hasOwnProperty("beforeShow")&&!this.options.pageChange[e].beforeShow(e,this.body.find("section#"+this.options.pageIDPrefix+e))?(this.goPage(this.#currentPageNumber+1,!1),!1):(this.#currentPageNumber=+e,this.#pageObjects.removeClass("current"),this.#currentPageObject=this.#pageObjects.eq(this.#currentPageNumber-1),this.#pageObjects.removeClass(this.options.currentPageClass),this.#currentPageObject.addClass(this.options.currentPageClass),0<this.options.breadcrumbs.length&&this.options.breadcrumbs.find("[data-step]").each(function(e,t){t=jQuery(t);t.removeClass("current past"),+t.attr("data-step")<this.#currentPageNumber?t.addClass("past"):+t.attr("data-step")===this.#currentPageNumber&&t.addClass("current").attr("data-visited","true")}.bind(this)),void(jQuery.windowSize.isMobile&&(0<this.options.breadcrumbs.length?jQuery("html, body").animate({scrollTop:this.options.breadcrumbs.offset().top},500):jQuery("html, body").animate({scrollTop:0},500)))))))}nextPage(e){e.preventDefault(),e.stopImmediatePropagation(),this.#newPageNumber=this.#currentPageNumber+1,this.goPage(this.#newPageNumber,!1)}previousPage(e){e.preventDefault(),e.stopImmediatePropagation(),1<this.#currentPageNumber&&(this.#newPageNumber=this.#currentPageNumber-1,this.goPage(this.#newPageNumber,!1))}errorPage(){for(var e=0;e<this.#pageObjects.length;e++)if(0<this.#pageObjects.eq(e).find(this.options.errorSelector).length){this.goPage(e+1,!1);break}}}
//# sourceMappingURL=TEGFakePages.min.js.map